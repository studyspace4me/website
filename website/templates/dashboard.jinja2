{% extends "layout.jinja2" %}

{% block title %}Dashboard - {{ super() }}{% endblock %}

{% block css %}
    {{ super() }}

    <link rel="stylesheet" href="{{ 'website:static/css/dashboard.css' | static_url }}"/>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&language=it"></script>
    <script type="text/javascript" src="{{ 'website:static/js/dynamicmap.js' | static_url }}"></script>
{% endblock %}

{% block urgentjs %}
    {{ super() }}

    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
    <script src="{{ 'website:static/js/angular.js' | static_url }}"> </script>
    <script src="{{ 'website:static/js/moment.js' | static_url }}"> </script>
{% endblock %}

{% block js %}
    {{ super() }}
{% endblock %}

{% block searchbox %}
        <div class="row">
                    <div class="small-8 small-centered columns">
                        <div class="row collapse" style="margin-top:6px; padding-top:0px;">
                            <div class="small-8 small-centered columns searchInputContainer" style="display:flex; margin-top: 0px; padding-top: 0px;">
                                <input type="text">
                            </div>
                            <div class="small-4 small-centered columns searchButtonContainer" style="float:right">
                                 <a href="#" class="button postfix searchButton">
                                    Search
                                </a>
                            </div>
                        </div>
                    </div>
        </div>
{% endblock %}

{% block content %}
    <!--WHERE THE MAP IS LOADED, THEN IS TRANSFERRED-->
    <div>
        <div id="map" style="width: inherit; height: inherit;"></div>
    <div/>

    <div id="dashboardSection" ng-app="customInterpolationApp" ng-controller="dashboardController">

        <!--ORDER BY-->
        <div class="row" id="orderbyContent">
            <div class="small-12 large-centered columns">
                <div class="row collapse prefix-radius">
                    <div class="icon-bar four-up">
                        <a class="item" id="all">
                            <img src="{{ 'website:static/assets/icons/all.svg' | static_url }}">
                        </a>
                        <a class="item" id="favorites" ng-click="">
                            <img src="{{ 'website:static/assets/icons/favorites.svg' | static_url }}">
                        </a>
                        <a class="item" id="nearest">
                            <img src="{{ 'website:static/assets/icons/near.svg' | static_url }}">
                        </a>
                        <a class="item" id="crowding">
                            <img src="{{ 'website:static/assets/icons/crowd.svg' | static_url }}">
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!--RESULT-->
        <div class="result" ng-repeat="x in results">
            <!--HEADER-->
            <div class="row header" id="headerResult">
                <div class="small-12 large-centered columns">
                    <div class="panel" ng-click="showContent(x.name)">  <!--onclick="getMap('b106')"-->
                           <span class="iconAndName">
                                <img ng-src="[[getRoomIcon(x.type)]]" class="roomIcon"><img>
                                &nbsp;
                                <strong>
                                    <span id="spaceName"> [[x.name]] </span>
                                </strong>
                           </span>

                           &nbsp;&nbsp;&nbsp;&nbsp;

                           <span class="summaryHeader">
                               <span id="location">
                                   [[x.location]]
                               </span>
                               <span id="until">
                                   <i>([[getTime(x.status.until)]]) :</i>
                               </span>
                               &nbsp;
                               <label class="radius label status" ng-style="getBackground(x.feedback)" id="headerStatus">[[x.feedback]]</label>
                               <label class="radius label updated" id="updated"><i>[[getLastUpdate(x.lastUpdate)]]</i></label>
                           </span>

                           <span class="favoriteStar">
                               <img ng-src="[[getFavoriteImage(x.favorite)]]" ng-click="changeFavorite([['favorite' + x.name]]); $event.stopPropagation();" class="favoriteIcon" id="[['favorite' + x.name]]"><img>
                           </span>
                    </div>
                 </div>
            </div>
            {# {{ 'website:static/assets/icons/[[x.favorite]]' | static_url }} #}

            <!--CONTENT-->
            <div class="row content">
                <div class="small-12 large-centered columns">
                    <div class="contentPanel panel" id="[[x.name]]" style="display: none;">
                        <div class="feedback">
                            <label class="title">Give your feedback:</label>
                            <ul class="button-group round">
                                <li><a href="#" class="tiny secondary button emptyStatus">&nbsp;Empty</a></li>
                                <li><a href="#" class="tiny secondary button averageStatus">Average</a></li>
                                <li><a href="#" class="tiny secondary button fullStatus">&nbsp;Full&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                            </ul>
                        </div>

                        <div class="mapContainer" id="[['map' + x.name]]"  style="width: 100%; height: 250px; margin-bottom: 20px; padding-bottom: 20px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}